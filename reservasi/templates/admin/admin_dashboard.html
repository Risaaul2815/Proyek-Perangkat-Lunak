{% extends "admin/base_admin.html" %}
{% load static %}
{% load humanize %}

{% block content %}

<h1 class="page-title">Dashboard Admin</h1>
<p class="subtitle">Selamat datang, Admin! Berikut ringkasan aktivitas hari ini:</p>

<div class="stats-grid">
    <div class="stats-card">
        <h3>Total Menu</h3>
        <p class="stats-number">{{ total_menu }}</p>
    </div>
    <div class="stats-card">
        <h3>Pesanan Hari Ini</h3>
        <p class="stats-number">{{ total_orders_today }}</p>
    </div>
    <div class="stats-card">
        <h3>Reservasi</h3>
        <p class="stats-number">{{ total_reservasi }}</p>
    </div>
</div>

<h2 class="section-title">Menu Terbaru</h2>
<table class="table">
    <thead>
        <tr>
            <th>Nama Menu</th>
            <th>Kategori</th>
            <th>Harga</th>
            <th>Tanggal Ditambahkan</th>
        </tr>
    </thead>
    <tbody>
        {% for item in recent_menu %}
        <tr>
            <td>{{ item.nama }}</td>
            <td>{{ item.kategori }}</td>
            <td>Rp {{ item.harga|intcomma }}</td>
            <td>{{ item.created_at|date:"d M Y" }}</td>
        </tr>
        {% empty %}
        <tr>
            <td colspan="4">Belum ada menu.</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<h2 class="section-title">Pesanan Terbaru</h2>
<table class="table">
    <thead>
        <tr>
            <th>Pelanggan</th>
            <th>Total</th>
            <th>Status</th>
            <th>Waktu</th>
        </tr>
    </thead>
    <tbody>
        {% for order in recent_orders %}
        <tr>
            <td>
                {% if order.customer %}
                    {{ order.customer.username }}
                {% else %}
                    Guest
                {% endif %}
            </td>
            <td>Rp {{ order.total_price|intcomma }}</td>
            <td>{{ order.status }}</td>
            <td>{{ order.order_time|date:"d M Y H:i" }}</td>
        </tr>
        {% empty %}
        <tr>
            <td colspan="5">Belum ada pesanan.</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<h2 class="section-title">Reservasi Terbaru</h2>
<table class="table">
    <thead>
        <tr>
            <th>Pelanggan</th>
            <th>Meja</th>
            <th>Tanggal</th>
            <th>Jam</th>
            <th>Jumlah Orang</th>
        </tr>
    </thead>
    <tbody>
        {% for res in recent_reservasi %}
        <tr>
            <td>
                {% if res.user %}
                    {{ res.user.username }}
                {% else %}
                    Guest
                {% endif %}
            </td>
            <td>
                {% if res.meja %}
                    {{ res.meja.nomor }}
                {% else %}
                    -
                {% endif %}
            </td>
            <td>{{ res.tanggal_reservasi|date:"d M Y" }}</td>
            <td>{{ res.jam_reservasi }}</td>
            <td>{{ res.jumlah_orang }}</td>
        </tr>
        {% empty %}
        <tr>
            <td colspan="6">Belum ada reservasi.</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<style>
.stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 20px;
    margin: 20px 0;
}
.stats-card {
    padding: 20px;
    background-color: #fff;
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    text-align: center;
}
.stats-card h3 { margin-bottom: 10px; font-size: 18px; color: #333; }
.stats-number { font-size: 28px; font-weight: bold; color: #2c3e50; }

.table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: 30px;
}
.table th, .table td {
    padding: 10px 15px;
    border: 1px solid #ddd;
}
.table th {
    background-color: #f4f4f4;
    text-align: left;
}
.section-title {
    margin-top: 40px;
    margin-bottom: 10px;
    font-size: 20px;
    color: #2c3e50;
}
</style>

{% endblock %}
